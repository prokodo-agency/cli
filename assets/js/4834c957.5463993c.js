"use strict";(globalThis.webpackChunk_prokodo_agency_cli_docs=globalThis.webpackChunk_prokodo_agency_cli_docs||[]).push([[82],{5002(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"ci-cd","title":"CI / CD Integration","description":"Integrate the prokodo CLI into CI/CD pipelines \u2014 GitHub Actions, GitLab CI, environment variable setup, and best practices.","source":"@site/docs/ci-cd.mdx","sourceDirName":".","slug":"/ci-cd","permalink":"/docs/ci-cd","draft":false,"unlisted":false,"editUrl":"https://github.com/prokodo-agency/cli/edit/main/public/docs/docs/ci-cd.mdx","tags":[],"version":"current","lastUpdatedBy":"Christian Salat","lastUpdatedAt":1771684166000,"sidebarPosition":9,"frontMatter":{"id":"ci-cd","title":"CI / CD Integration","sidebar_position":9,"description":"Integrate the prokodo CLI into CI/CD pipelines \u2014 GitHub Actions, GitLab CI, environment variable setup, and best practices.","keywords":["prokodo CI/CD","prokodo GitHub Actions","prokodo CI pipeline","prokodo automated verification","prokodo GitLab CI"]},"sidebar":"cliSidebar","previous":{"title":"\u2699\ufe0f Configuration","permalink":"/docs/configuration"},"next":{"title":"\ud83d\udee0 Troubleshooting","permalink":"/docs/troubleshooting"}}');var o=i(6070),r=i(4134);const t={id:"ci-cd",title:"CI / CD Integration",sidebar_position:9,description:"Integrate the prokodo CLI into CI/CD pipelines \u2014 GitHub Actions, GitLab CI, environment variable setup, and best practices.",keywords:["prokodo CI/CD","prokodo GitHub Actions","prokodo CI pipeline","prokodo automated verification","prokodo GitLab CI"]},c="CI / CD Integration",d={},l=[{value:"Key principles",id:"key-principles",level:2},{value:"GitHub Actions",id:"github-actions",level:2},{value:"Minimal example",id:"minimal-example",level:3},{value:"With health check + tagging",id:"with-health-check--tagging",level:3},{value:"Capture result as a step output",id:"capture-result-as-a-step-output",level:3},{value:"Adding the secret",id:"adding-the-secret",level:2},{value:"GitLab CI",id:"gitlab-ci",level:2},{value:"CircleCI",id:"circleci",level:2},{value:"Best practices",id:"best-practices",level:2},{value:"Local development vs CI",id:"local-development-vs-ci",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"ci--cd-integration",children:"CI / CD Integration"})}),"\n",(0,o.jsx)(n.p,{children:"The prokodo CLI is designed to run headlessly in any CI environment."}),"\n",(0,o.jsx)(n.h2,{id:"key-principles",children:"Key principles"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["All user-facing prompts are suppressed when ",(0,o.jsx)(n.code,{children:"stdin"})," is not a TTY"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"--json"})," emits structured output to ",(0,o.jsx)(n.code,{children:"stdout"}),"; logs go to ",(0,o.jsx)(n.code,{children:"stderr"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"--no-color"})," (or ",(0,o.jsx)(n.code,{children:"NO_COLOR=1"}),") removes ANSI codes that pollute CI logs"]}),"\n",(0,o.jsxs)(n.li,{children:["Exit codes are strict: ",(0,o.jsx)(n.code,{children:"0"})," = pass, ",(0,o.jsx)(n.code,{children:"1"})," = fail, ",(0,o.jsx)(n.code,{children:"2"})," = setup error"]}),"\n",(0,o.jsxs)(n.li,{children:["Credentials are read from the ",(0,o.jsx)(n.code,{children:"PROKODO_API_KEY"})," environment variable \u2014 no credentials file needed"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,o.jsx)(n.h3,{id:"minimal-example",children:"Minimal example"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"name: Verify\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n\njobs:\n  prokodo-verify:\n    name: prokodo verify\n    runs-on: ubuntu-latest\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '22'\n\n      - name: Install prokodo CLI\n        run: npm install -g prokodo\n\n      - name: Verify\n        run: prokodo verify --json --no-color\n        env:\n          PROKODO_API_KEY: ${{ secrets.PROKODO_API_KEY }}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"with-health-check--tagging",children:"With health check + tagging"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"steps:\n  - uses: actions/checkout@v4\n\n  - uses: actions/setup-node@v4\n    with:\n      node-version: '22'\n\n  - name: Install prokodo CLI\n    run: npm install -g prokodo\n\n  - name: Environment health check\n    run: prokodo doctor --json --no-color\n    env:\n      PROKODO_API_KEY: ${{ secrets.PROKODO_API_KEY }}\n\n  - name: Verify\n    run: |\n      prokodo verify \\\n        --ref ${{ github.sha }} \\\n        --timeout 600 \\\n        --json \\\n        --no-color\n    env:\n      PROKODO_API_KEY: ${{ secrets.PROKODO_API_KEY }}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"capture-result-as-a-step-output",children:"Capture result as a step output"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'- name: Verify\n  id: verify\n  run: |\n    RESULT=$(prokodo verify --json --no-color 2>/dev/null)\n    echo "result=$RESULT" >> "$GITHUB_OUTPUT"\n  env:\n    PROKODO_API_KEY: ${{ secrets.PROKODO_API_KEY }}\n\n- name: Report\n  if: always()\n  run: echo \'${{ steps.verify.outputs.result }}\' | jq .\n'})}),"\n",(0,o.jsx)(n.h2,{id:"adding-the-secret",children:"Adding the secret"}),"\n",(0,o.jsx)(n.p,{children:"In your GitHub repository:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Go to ",(0,o.jsx)(n.strong,{children:"Settings \u2192 Secrets and variables \u2192 Actions"})]}),"\n",(0,o.jsxs)(n.li,{children:["Click ",(0,o.jsx)(n.strong,{children:"New repository secret"})]}),"\n",(0,o.jsxs)(n.li,{children:["Name: ",(0,o.jsx)(n.code,{children:"PROKODO_API_KEY"})]}),"\n",(0,o.jsx)(n.li,{children:"Value: your API key from the prokodo marketplace"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"gitlab-ci",children:"GitLab CI"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'prokodo-verify:\n  image: node:22\n  stage: test\n  script:\n    - npm install -g prokodo\n    - prokodo doctor --json --no-color\n    - prokodo verify --ref "$CI_COMMIT_SHA" --json --no-color\n  variables:\n    PROKODO_API_KEY: $PROKODO_API_KEY   # set in GitLab CI/CD variables\n'})}),"\n",(0,o.jsx)(n.h2,{id:"circleci",children:"CircleCI"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"jobs:\n  prokodo-verify:\n    docker:\n      - image: cimg/node:22.0\n    steps:\n      - checkout\n      - run:\n          name: Install prokodo CLI\n          command: npm install -g prokodo\n      - run:\n          name: Verify\n          command: prokodo verify --ref $CIRCLE_SHA1 --json --no-color\n          environment:\n            PROKODO_API_KEY: $PROKODO_API_KEY\n"})}),"\n",(0,o.jsx)(n.h2,{id:"best-practices",children:"Best practices"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Recommendation"}),(0,o.jsx)(n.th,{children:"Reason"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsxs)(n.td,{children:["Use ",(0,o.jsx)(n.code,{children:"PROKODO_API_KEY"})," env var"]}),(0,o.jsx)(n.td,{children:"Never commit credentials; secrets are per-environment"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsxs)(n.td,{children:["Pass ",(0,o.jsx)(n.code,{children:"--json"})]}),(0,o.jsx)(n.td,{children:"Structured output is easier to parse in subsequent steps"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsxs)(n.td,{children:["Pass ",(0,o.jsx)(n.code,{children:"--no-color"})," or set ",(0,o.jsx)(n.code,{children:"NO_COLOR=1"})]}),(0,o.jsx)(n.td,{children:"Prevents ANSI escape codes in CI logs"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsxs)(n.td,{children:["Pass ",(0,o.jsx)(n.code,{children:"--ref ${{ github.sha }}"})]}),(0,o.jsx)(n.td,{children:"Tags runs with commit SHA for traceability in the dashboard"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsxs)(n.td,{children:["Run ",(0,o.jsx)(n.code,{children:"doctor"})," before ",(0,o.jsx)(n.code,{children:"verify"})]}),(0,o.jsx)(n.td,{children:"Surfaces environment problems early with clear messages"})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"local-development-vs-ci",children:"Local development vs CI"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Scenario"}),(0,o.jsx)(n.th,{children:"Auth method"}),(0,o.jsx)(n.th,{children:"Extra flags"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Developer laptop"}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"prokodo auth login"})," \u2192 credentials file"]}),(0,o.jsx)(n.td,{children:"\u2014"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"CI pipeline"}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"PROKODO_API_KEY"})," secret"]}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"--json"}),", ",(0,o.jsx)(n.code,{children:"--no-color"})]})]})]})]}),"\n",(0,o.jsxs)(n.p,{children:["You never need ",(0,o.jsx)(n.code,{children:"auth login"})," in CI.  The env var is read automatically with the same priority as the credentials file."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},4134(e,n,i){i.d(n,{R:()=>t,x:()=>c});var s=i(758);const o={},r=s.createContext(o);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);