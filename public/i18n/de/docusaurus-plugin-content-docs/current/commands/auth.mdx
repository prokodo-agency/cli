---
id: auth
title: auth
sidebar_position: 2
description: API-Schlüssel mit dem auth-Befehl verwalten — login, logout und whoami-Unterbefehle erklärt.
keywords:
  [
    prokodo auth,
    prokodo API-Schlüssel,
    prokodo auth login,
    prokodo auth logout,
    prokodo CLI Authentifizierung,
  ]
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# `prokodo auth`

API-Schlüssel-Zugangsdaten verwalten.

```
prokodo auth <unterbefehl> [Optionen]
```

## Unterbefehle

### `auth login`

API-Schlüssel in der Zugangsdatei unter `~/.config/prokodo/credentials.json` speichern.

```bash
prokodo auth login --key <schluessel>
```

**Optionen**

| Flag           | Typ    | Beschreibung                                                                |
| -------------- | ------ | --------------------------------------------------------------------------- |
| `--key <wert>` | String | Zu speichernder API-Schlüssel. Weglassen für interaktive Eingabe (nur TTY). |

**Verhalten**

1. Schlüsselformat validieren (≥ 8 Zeichen, keine `<`- oder `>`-Platzhalter)
2. Health-Check gegen API durchführen (ohne Dateiänderung), um Schlüssel zu bestätigen
3. `~/.config/prokodo/credentials.json` mit `0600`-Berechtigungen schreiben
4. Maskierten Schlüsselhinweis bei Erfolg ausgeben

**Beispiele**

<Tabs groupId="login-mode">
  <TabItem value="text" label="Textausgabe">

```bash
prokodo auth login --key pk_abc123xyz789
```

```
✓ Erfolgreich authentifiziert (••••••••xyz789)
ℹ Zugangsdaten gespeichert unter: /Users/du/.config/prokodo/credentials.json
```

  </TabItem>
  <TabItem value="json" label="--json">

```bash
prokodo auth login --key pk_abc123xyz789 --json
```

```json
{ "authenticated": true, "keyHint": "••••••••xyz789" }
```

  </TabItem>
</Tabs>

**Exit-Codes**

| Code | Ursache                                    |
| ---- | ------------------------------------------ |
| `0`  | Schlüssel erfolgreich gespeichert          |
| `2`  | Kein Schlüssel im nicht-interaktiven Modus |
| `2`  | Schlüssel besteht Format-Validierung nicht |
| `1`  | API hat den Schlüssel abgelehnt            |

:::note
Wenn `stdin` kein TTY ist (CI, Docker, Pipe), ist das `--key`-Flag erforderlich. Die CLI beendet sich mit `2` und einer Erklärung, wenn es fehlt.
:::

:::tip
In CI/CD-Umgebungen wird empfohlen, die Umgebungsvariable `PROKODO_API_KEY` zu verwenden, anstatt `auth login` auszuführen. Die CLI liest diese automatisch aus.
:::

---

### `auth logout`

Gespeicherte Zugangsdatei entfernen.

```bash
prokodo auth logout
```

**Verhalten**

- Löscht `~/.config/prokodo/credentials.json`, falls vorhanden
- Beendet sich mit `0`, unabhängig davon ob Zugangsdaten vorhanden waren (idempotent)
- Gibt an, ob Zugangsdaten tatsächlich entfernt wurden

**Beispiele**

<Tabs groupId="logout-mode">
  <TabItem value="text" label="Textausgabe">

```bash
prokodo auth logout
```

```
✓ Zugangsdaten entfernt.
```

oder wenn nicht angemeldet:

```
ℹ Keine Zugangsdaten gespeichert.
```

  </TabItem>
  <TabItem value="json" label="--json">

```bash
prokodo auth logout --json
```

```json
{ "loggedOut": true }
```

oder:

```json
{ "loggedOut": false }
```

  </TabItem>
</Tabs>

---

### `auth whoami`

Aktuell aktiven API-Schlüssel anzeigen (maskiert — letzte 4 Zeichen sichtbar) und Quelle.

```bash
prokodo auth whoami
```

**Prioritätskette** (höchste bis niedrigste):

1. `--api-key` CLI-Flag
2. `PROKODO_API_KEY` Umgebungsvariable
3. `~/.config/prokodo/credentials.json`

Falls keiner gefunden wird, Exit `2` mit Hinweisen.

**Beispiele**

<Tabs groupId="whoami-mode">
  <TabItem value="text" label="Textausgabe">

```bash
prokodo auth whoami
```

```
API key: ••••••••xyz789
Source: credentials file
```

  </TabItem>
  <TabItem value="json" label="--json">

```bash
PROKODO_API_KEY=pk_test prokodo auth whoami --json
```

```json
{ "keyHint": "••••test" }
```

  </TabItem>
</Tabs>

## Speicherort der Zugangsdaten

| Betriebssystem | Pfad                                 |
| -------------- | ------------------------------------ |
| macOS / Linux  | `~/.config/prokodo/credentials.json` |
| Windows        | `%APPDATA%\prokodo\credentials.json` |

Die Datei wird auf POSIX-Systemen mit `0600`-Berechtigungen erstellt. Beim Start wird eine Warnung ausgegeben, wenn die Berechtigungen zu weitreichend sind.
